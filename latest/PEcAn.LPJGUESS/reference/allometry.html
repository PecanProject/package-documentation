<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>LPJ-GUESS allometry — allometry • PEcAn.LPJGUESS</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="LPJ-GUESS allometry — allometry"><meta name="description" content="The LPJ-GUESS allometry function transcribed into R."><meta property="og:description" content="The LPJ-GUESS allometry function transcribed into R."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PEcAn.LPJGUESS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.9.0</small>

    <a href="../index.html" style="padding: 0em 1em">← Up</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>LPJ-GUESS allometry</h1>
      <small class="dont-index">Source: <a href="https://github.com/PecanProject/pecan/blob/main/models/lpjguess/R/allometry.LPJGUESS.R" class="external-link"><code>R/allometry.LPJGUESS.R</code></a></small>
      <div class="d-none name"><code>allometry.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The LPJ-GUESS allometry function transcribed into R.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">allometry</span><span class="op">(</span></span>
<span>  <span class="va">lifeform</span>,</span>
<span>  <span class="va">cmass_leaf</span>,</span>
<span>  <span class="va">cmass_sap</span>,</span>
<span>  <span class="va">cmass_heart</span>,</span>
<span>  <span class="va">densindiv</span>,</span>
<span>  <span class="va">age</span>,</span>
<span>  <span class="va">fpc</span>,</span>
<span>  <span class="va">deltafpc</span>,</span>
<span>  <span class="va">sla</span>,</span>
<span>  <span class="va">k_latosa</span>,</span>
<span>  <span class="va">k_rp</span>,</span>
<span>  <span class="va">k_allom1</span>,</span>
<span>  <span class="va">k_allom2</span>,</span>
<span>  <span class="va">k_allom3</span>,</span>
<span>  <span class="va">wooddens</span>,</span>
<span>  <span class="va">crownarea_max</span>,</span>
<span>  HEIGHT_MAX <span class="op">=</span> <span class="fl">150</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-lifeform">lifeform<a class="anchor" aria-label="anchor" href="#arg-lifeform"></a></dt>
<dd><p>An integer code for the lifeform of this individual (cohort): 1 = Tree, 2 = Grass</p></dd>


<dt id="arg-cmass-leaf">cmass_leaf<a class="anchor" aria-label="anchor" href="#arg-cmass-leaf"></a></dt>
<dd><p>The leaf C pool size (kgC/m^2)</p></dd>


<dt id="arg-cmass-sap">cmass_sap<a class="anchor" aria-label="anchor" href="#arg-cmass-sap"></a></dt>
<dd><p>The sapwood C pool size (kgC/m^2)</p></dd>


<dt id="arg-cmass-heart">cmass_heart<a class="anchor" aria-label="anchor" href="#arg-cmass-heart"></a></dt>
<dd><p>The heartwood C pool size (kgC/m^2)</p></dd>


<dt id="arg-densindiv">densindiv<a class="anchor" aria-label="anchor" href="#arg-densindiv"></a></dt>
<dd><p>The density of individuals in the cohort (indiv/m^2)</p></dd>


<dt id="arg-age">age<a class="anchor" aria-label="anchor" href="#arg-age"></a></dt>
<dd><p>The age of the coort</p></dd>


<dt id="arg-fpc">fpc<a class="anchor" aria-label="anchor" href="#arg-fpc"></a></dt>
<dd><p>The folar projective cover</p></dd>


<dt id="arg-deltafpc">deltafpc<a class="anchor" aria-label="anchor" href="#arg-deltafpc"></a></dt>
<dd><p>The change in foliar projective cover</p></dd>


<dt id="arg-sla">sla<a class="anchor" aria-label="anchor" href="#arg-sla"></a></dt>
<dd><p>The SLA (specific leaf area) (per PFT parameter)</p></dd>


<dt id="arg-k-latosa">k_latosa<a class="anchor" aria-label="anchor" href="#arg-k-latosa"></a></dt>
<dd><p>The leaf area to sapwood area ratio (per PFT parameter)</p></dd>


<dt id="arg-k-rp-k-allom-k-allom-k-allom-">k_rp, k_allom1, k_allom2, k_allom3, <a class="anchor" aria-label="anchor" href="#arg-k-rp-k-allom-k-allom-k-allom-"></a></dt>
<dd><p>Allometry coefficients (per PFT parameters)</p></dd>


<dt id="arg-wooddens">wooddens<a class="anchor" aria-label="anchor" href="#arg-wooddens"></a></dt>
<dd><p>Wood density (kgC/m^2) (per PFT parameter)</p></dd>


<dt id="arg-crownarea-max">crownarea_max<a class="anchor" aria-label="anchor" href="#arg-crownarea-max"></a></dt>
<dd><p>Maximum allowed crown area (m^2)  (per PFT parameter)</p></dd>


<dt id="arg-height-max">HEIGHT_MAX<a class="anchor" aria-label="anchor" href="#arg-height-max"></a></dt>
<dd><p>Maximum allowed height of an individual.  This is the maximum height that a tree
can have.  This is hard-coded in LPJ-GUESS to 150 m, but for SDA that might be unrealistically big,
so this argument allows adjustment.</p>
<p>This function was transcribed from LPJ-GUESS (v4.0) C++ to R for the purpose of nudging the LPJ-GUESS state offline.
The idea is of course to use the output from the analysis step from an SDA routine to provide the nudged values, although that isn't
relevant to the following code.</p>
<p>Since the original C++ code took as its only argument an LPJ-GUESS C++ class of type 'Individual' there was no way (to my knowledge)
of directly compiling using Rcpp (unlike for allocation.cpp/allocation.R. which was easy to compile from the native C++ using
Rcpp with very few changes).</p>
<p>As noted in the original function header taken from the the C++ code (copied above), this function should be run after its biomass values
have been updated.  In this case that means after the allocation() function has been applied to an individual.</p>
<p>This function can return following error codes:
 1.  "NegligibleLeafMass" - The individual has negligible leaf biomass.
 2.  "MaxHeightExceeded" - The indidual exceeds the maximum allowed height
 3.  "LowWoodDensity" - The individual's *actual* wood density drops below 90<!-- % of prescribed value.  This (slighty weird -->
 and unphysical) requirement is necessary because sometimes LPJ-GUESS can take carbon from the heartwood to
 ensure C-balance.  I think.  Or some other hockery-pockery.</p>
<p>If all is well the code is simply "OK".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A named list of updated state variables for the individual/cohort.  The first value in the list is the error code.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Matthew Forrest</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Istem Fer, Tony Gardella.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

