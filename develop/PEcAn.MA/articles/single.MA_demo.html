<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Example of Single.MA • PEcAn.MA</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example of Single.MA">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">PEcAn.MA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.4</small>

    <a href="../index.html" style="padding: 0em 1em">← Up</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/single.MA_demo.html">Example of Single.MA</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Example of Single.MA</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/PecanProject/pecan/blob/develop/modules/meta.analysis/vignettes/single.MA_demo.Rmd" class="external-link"><code>vignettes/single.MA_demo.Rmd</code></a></small>
      <div class="d-none name"><code>single.MA_demo.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="meta-analysis-example-of-single-ma">Meta-analysis: Example of Single.MA<a class="anchor" aria-label="anchor" href="#meta-analysis-example-of-single-ma"></a>
</h2>
<p>Individual Meta-analysis</p>
<p>Individual meta-analysis for a specific trait and PFT is run by the
function single.MA. This will allow power analysis to run repeated MA
outside of the full loop over traits and PFTs.</p>
<p>The first step is to convert the R distribution to JAGS distribution.
The prior transformed is then stored in jagsprior and the parameters are
renamed as “distn”, “a”, “b” and “n”. The input used here is a simple
example with 4 observations. r2bugs.distributions function is to convert
R parameterizations to BUGS paramaterizations or to convert from BUGS to
R. It can work on the distributions including normal, weibull, gamma,
chsq, binormial, negative binormial. The input of this function are
information of the prior distribution, including the name of the
distribution and 2 parameters. It will convert the parameterization
format from R to BUGS or from BUGS to R automaticaly.</p>
<p>jagify is to convert queried data to format required by JAGS
meta-analysis model.</p>
<p>In the single.MA function, when input the trait data and prior, it
will transfer the prior from R parameterization into BUGS
parameterization by using the function r2bugs.distributions. Using the
jags.model function, the Bayesian graphical model is generated based on
the initials. The posterior samples in mcmc.list format are then created
as the output of the function.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="va">opts_chunk</span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>echo <span class="op">=</span> <span class="cn">FALSE</span>, message <span class="op">=</span> <span class="cn">FALSE</span>, results<span class="op">=</span><span class="st">'hide'</span>, cache<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>               eval <span class="op">=</span> <span class="cn">FALSE</span> <span class="co">## just to allow .md to be compiled</span></span>
<span>               <span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://pecanproject.github.io" class="external-link">PEcAn.MA</a></span><span class="op">)</span></span>
<span><span class="co">##initializing</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.3</span>,<span class="fl">1.0976426</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">3.4</span>,<span class="fl">2.1821789</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">5.9</span>,<span class="fl">0.9622504</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">6.6</span>,<span class="fl">1.3245324</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>,row.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Y"</span>,<span class="st">"obs.prec"</span>,<span class="st">"n"</span>,<span class="st">"ghs"</span>,<span class="st">"trt"</span>,<span class="st">"site"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">j.chains</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">j.iter</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">jag.model.file</span> <span class="op">&lt;-</span> <span class="st">"tesst.bug"</span></span>
<span><span class="va">tauA</span> <span class="op">&lt;-</span> <span class="fl">0.001</span></span>
<span><span class="va">tauB</span> <span class="op">&lt;-</span> <span class="fl">0.001</span></span>
<span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>distn <span class="op">=</span> <span class="st">"norm"</span>, parama <span class="op">=</span> <span class="fl">0</span>, paramb <span class="op">=</span> <span class="fl">2</span>, n <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="co">##running single.MA</span></span>
<span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/single.MA.html">single.MA</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">j.chains</span>, <span class="va">j.iter</span>, <span class="va">tauA</span>, <span class="va">tauB</span>, <span class="va">prior</span>,<span class="va">jag.model.file</span>, overdispersed<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Compiling model graph</span></span>
<span><span class="co">##    Resolving undeclared variables</span></span>
<span><span class="co">##    Allocating nodes</span></span>
<span><span class="co">## Graph information:</span></span>
<span><span class="co">##    Observed stochastic nodes: 8</span></span>
<span><span class="co">##    Unobserved stochastic nodes: 2</span></span>
<span><span class="co">##    Total graph size: 25</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Initializing model</span></span></code></pre>
<p>The meta-analysis outputs are summarized by the pecan.ma.summary
function. It will create several log files for all the traits to record
the R output of the convergency diagnosis, and several PDF file for all
the traits to store the diagnosis plot of convergency. G-R diagnostics
is used to test convergence. The diagnose result is output into the log
file. If the JAGS model failed to converge, a warning will also be
generated.</p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mike Dietze, David LeBauer, Xiaohui Feng, Dan Wang, Carl Davidson, Rob Kooper, Shawn Serbin, Shashank Singh.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
